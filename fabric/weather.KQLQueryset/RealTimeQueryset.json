{"payload":{"tabs":[{"id":"81db5d36-2f36-4239-a6b1-ad9f1ea7e98b","queryRange":{"startLineNumber":1,"startColumn":1,"endLineNumber":22,"endColumn":1},"title":"Create bronze","text":".create table BronzeWeather (\n    isigmetId: int,\n    icaoId: string,\n    firId: string,\n    firName: string,\n    receiptTime: datetime,\n    validTimeFrom: int,\n    validTimeTo: int,\n    seriesId: string,\n    hazard: string,\n    qualifier: string,\n    base: int,\n    top: int,\n    geom: string,\n    coords: dynamic,\n    dir: string,\n    spd: int,\n    chng: string,\n    rawSigmet: string,\n    polygon: dynamic\n)\n","commandInContext":".create table BronzeWeather (\n    isigmetId: int,\n    icaoId: string,\n    firId: string,\n    firName: string,\n    receiptTime: datetime,\n    validTimeFrom: int,\n    validTimeTo: int,\n    seriesId: string,\n    hazard: string,\n    qualifier: string,\n    base: int,\n    top: int,\n    geom: string,\n    coords: dynamic,\n    dir: string,\n    spd: int,\n    chng: string,\n    rawSigmet: string,\n    polygon: dynamic\n)\n","executionStatus":"done","clientRequestId":"Kusto.Web.RTA.QuerySet;bf9fb718-f6b1-46c9-be72-30cc3318786f;cee89284-9172-4f25-bff6-326b9afc3d12","completionInfo":1322343900,"entityInContext":"trd-kz4sd5vknmz3u5t26m.z2/ac257cd3-e45d-4c3c-a1d8-b4589541f6c8","commandType":"AdminCommand","commandWithoutLeadingComments":".create table BronzeWeather (\n    isigmetId: int,\n    icaoId: string,\n    firId: string,\n    firName: string,\n    receiptTime: datetime,\n    validTimeFrom: int,\n    validTimeTo: int,\n    seriesId: string,\n    hazard: string,\n    qualifier: string,\n    base: int,\n    top: int,\n    geom: string,\n    coords: dynamic,\n    dir: string,\n    spd: int,\n    chng: string,\n    rawSigmet: string,\n    polygon: dynamic\n)","hideEmptyColumns":false,"cursorPosition":{"lineNumber":22,"column":1}},{"id":"eba58d15-c79c-494c-a3a2-0c4637c8088a","queryRange":{"startLineNumber":1,"startColumn":1,"endLineNumber":1,"endColumn":33},"title":"Clear bronze","text":".clear table BronzeWeather data ","commandInContext":".clear table BronzeWeather data ","executionStatus":"notStarted","clientRequestId":null,"entityInContext":"trd-kz4sd5vknmz3u5t26m.z2/ac257cd3-e45d-4c3c-a1d8-b4589541f6c8","commandType":"AdminCommand","commandWithoutLeadingComments":".clear table BronzeWeather data","hideEmptyColumns":false,"cursorPosition":{"lineNumber":1,"column":1}},{"id":"2d0d3c93-9660-41fd-a804-9998de6f259a","queryRange":{"startLineNumber":1,"startColumn":1,"endLineNumber":28,"endColumn":1},"title":"Create silver","text":".execute database script <|\n.create table [SilverWeather] (\n    isigmetId: int,\n    icaoId: string,\n    firId: string,\n    firName: string,\n    receiptTime: datetime,\n    seriesId: string,\n    hazard: string,\n    qualifier: string,\n    base: int,\n    top: int,\n    geom: string,\n    coords: dynamic,\n    dir: string,\n    spd: int,\n    chng: string,\n    rawSigmet: string,\n    polygon: dynamic,\n    validTimeToTimestamp: datetime,\n    validTimeFromTimestamp: datetime,\n    polygon_densified: dynamic,\n    polygon_s2: dynamic,\n    bronze_timestamp: datetime,\n    silver_timestamp: datetime\n)\n\n.alter-merge table SilverWeather policy update @'[{\"IsEnabled\": true, \"Source\": \"BronzeWeather\", \"Query\": \"BronzeWeather | where isnotempty(coords) and geom == \\\"AREA\\\" | extend validTimeToTimestamp = datetime_add(\\\"second\\\", validTimeTo, datetime(1970-01-01T00:00:00Z)) | extend validTimeFromTimestamp = datetime_add(\\\"second\\\", validTimeFrom, datetime(1970-01-01T00:00:00Z)) | project-away validTimeFrom, validTimeTo | where validTimeToTimestamp > now() | extend polygon_densified = geo_polygon_densify(polygon)| where array_length(set_difference(polygon_densified.coordinates[0][0], dynamic([180.0,90.0]))) > 0 and array_length(set_difference(polygon_densified.coordinates[0][1], dynamic([-180.0,90.0]))) > 0 and array_length(set_difference(polygon_densified.coordinates[0][2], dynamic([-180.0,-90.0]))) > 0 and array_length(set_difference(polygon_densified.coordinates[0][3], dynamic([180.0,-90.0]))) > 0 and array_length(set_difference(polygon_densified.coordinates[0][4], dynamic([180.0,90.0]))) > 0| extend polygon_s2 = geo_polygon_to_s2cells(polygon_densified, 0)| extend bronze_timestamp = ingestion_time() | extend silver_timestamp = now()\", \"IsTransactional\": false}]'","commandInContext":".execute database script <|\n.create table [SilverWeather] (\n    isigmetId: int,\n    icaoId: string,\n    firId: string,\n    firName: string,\n    receiptTime: datetime,\n    seriesId: string,\n    hazard: string,\n    qualifier: string,\n    base: int,\n    top: int,\n    geom: string,\n    coords: dynamic,\n    dir: string,\n    spd: int,\n    chng: string,\n    rawSigmet: string,\n    polygon: dynamic,\n    validTimeToTimestamp: datetime,\n    validTimeFromTimestamp: datetime,\n    polygon_densified: dynamic,\n    polygon_s2: dynamic,\n    bronze_timestamp: datetime,\n    silver_timestamp: datetime\n)\n\n","executionStatus":"done","clientRequestId":"Kusto.Web.RTA.QuerySet;453c49f7-c864-45c7-adbe-412ce29a0a85;b831c914-296d-48ca-80e4-180cfae9d5f6","entityInContext":"trd-kz4sd5vknmz3u5t26m.z2/ac257cd3-e45d-4c3c-a1d8-b4589541f6c8","commandType":"AdminCommand","commandWithoutLeadingComments":".execute database script <|\n.create table [SilverWeather] (\n    isigmetId: int,\n    icaoId: string,\n    firId: string,\n    firName: string,\n    receiptTime: datetime,\n    seriesId: string,\n    hazard: string,\n    qualifier: string,\n    base: int,\n    top: int,\n    geom: string,\n    coords: dynamic,\n    dir: string,\n    spd: int,\n    chng: string,\n    rawSigmet: string,\n    polygon: dynamic,\n    validTimeToTimestamp: datetime,\n    validTimeFromTimestamp: datetime,\n    polygon_densified: dynamic,\n    polygon_s2: dynamic,\n    bronze_timestamp: datetime,\n    silver_timestamp: datetime\n)","hideEmptyColumns":false,"cursorPosition":{"lineNumber":3,"column":9}},{"id":"22ed3bbe-3a96-4db6-a525-1deb1b238af2","queryRange":{"startLineNumber":1,"startColumn":1,"endLineNumber":4,"endColumn":1180},"title":"Clear silver","text":".execute database script <|\n.clear table SilverWeather data\n.delete table SilverWeather policy update\n.alter-merge table SilverWeather policy update @'[{\"IsEnabled\": true, \"Source\": \"BronzeWeather\", \"Query\": \"BronzeWeather | where isnotempty(coords) and geom == \\\"AREA\\\" | extend validTimeToTimestamp = datetime_add(\\\"second\\\", validTimeTo, datetime(1970-01-01T00:00:00Z)) | extend validTimeFromTimestamp = datetime_add(\\\"second\\\", validTimeFrom, datetime(1970-01-01T00:00:00Z)) | project-away validTimeFrom, validTimeTo | where validTimeToTimestamp > now() | extend polygon_densified = geo_polygon_densify(polygon)| where array_length(set_difference(polygon_densified.coordinates[0][0], dynamic([180.0,90.0]))) > 0 and array_length(set_difference(polygon_densified.coordinates[0][1], dynamic([-180.0,90.0]))) > 0 and array_length(set_difference(polygon_densified.coordinates[0][2], dynamic([-180.0,-90.0]))) > 0 and array_length(set_difference(polygon_densified.coordinates[0][3], dynamic([180.0,-90.0]))) > 0 and array_length(set_difference(polygon_densified.coordinates[0][4], dynamic([180.0,90.0]))) > 0| extend polygon_s2 = geo_polygon_to_s2cells(polygon_densified, 0)| extend bronze_timestamp = ingestion_time() | extend silver_timestamp = now()\", \"IsTransactional\": false}]'","commandInContext":".execute database script <|\n.clear table SilverWeather data\n.delete table SilverWeather policy update\n.alter-merge table SilverWeather policy update @'[{\"IsEnabled\": true, \"Source\": \"BronzeWeather\", \"Query\": \"BronzeWeather | where isnotempty(coords) and geom == \\\"AREA\\\" | extend validTimeToTimestamp = datetime_add(\\\"second\\\", validTimeTo, datetime(1970-01-01T00:00:00Z)) | extend validTimeFromTimestamp = datetime_add(\\\"second\\\", validTimeFrom, datetime(1970-01-01T00:00:00Z)) | project-away validTimeFrom, validTimeTo | where validTimeToTimestamp > now() | extend polygon_densified = geo_polygon_densify(polygon)| where array_length(set_difference(polygon_densified.coordinates[0][0], dynamic([180.0,90.0]))) > 0 and array_length(set_difference(polygon_densified.coordinates[0][1], dynamic([-180.0,90.0]))) > 0 and array_length(set_difference(polygon_densified.coordinates[0][2], dynamic([-180.0,-90.0]))) > 0 and array_length(set_difference(polygon_densified.coordinates[0][3], dynamic([180.0,-90.0]))) > 0 and array_length(set_difference(polygon_densified.coordinates[0][4], dynamic([180.0,90.0]))) > 0| extend polygon_s2 = geo_polygon_to_s2cells(polygon_densified, 0)| extend bronze_timestamp = ingestion_time() | extend silver_timestamp = now()\", \"IsTransactional\": false}]'","executionStatus":"done","clientRequestId":"Kusto.Web.RTA.QuerySet;453c49f7-c864-45c7-adbe-412ce29a0a85;0ddecc9d-2fab-40ed-97f8-624e657f8ae0","entityInContext":"trd-kz4sd5vknmz3u5t26m.z2/ac257cd3-e45d-4c3c-a1d8-b4589541f6c8","commandType":"AdminCommand","commandWithoutLeadingComments":".execute database script <|\n.clear table SilverWeather data\n.delete table SilverWeather policy update\n.alter-merge table SilverWeather policy update @'[{\"IsEnabled\": true, \"Source\": \"BronzeWeather\", \"Query\": \"BronzeWeather | where isnotempty(coords) and geom == \\\"AREA\\\" | extend validTimeToTimestamp = datetime_add(\\\"second\\\", validTimeTo, datetime(1970-01-01T00:00:00Z)) | extend validTimeFromTimestamp = datetime_add(\\\"second\\\", validTimeFrom, datetime(1970-01-01T00:00:00Z)) | project-away validTimeFrom, validTimeTo | where validTimeToTimestamp > now() | extend polygon_densified = geo_polygon_densify(polygon)| where array_length(set_difference(polygon_densified.coordinates[0][0], dynamic([180.0,90.0]))) > 0 and array_length(set_difference(polygon_densified.coordinates[0][1], dynamic([-180.0,90.0]))) > 0 and array_length(set_difference(polygon_densified.coordinates[0][2], dynamic([-180.0,-90.0]))) > 0 and array_length(set_difference(polygon_densified.coordinates[0][3], dynamic([180.0,-90.0]))) > 0 and array_length(set_difference(polygon_densified.coordinates[0][4], dynamic([180.0,90.0]))) > 0| extend polygon_s2 = geo_polygon_to_s2cells(polygon_densified, 0)| extend bronze_timestamp = ingestion_time() | extend silver_timestamp = now()\", \"IsTransactional\": false}]'","hideEmptyColumns":false,"cursorPosition":{"lineNumber":4,"column":1180}},{"id":"20577acf-15a6-4b0d-8baf-3743cc36abea","queryRange":{"startLineNumber":3,"startColumn":1,"endLineNumber":14,"endColumn":2},"title":"GoldWeather","text":".drop materialized-view GoldWeather\n\n.create materialized-view with (backfill=true) GoldWeather on table SilverWeather\n{ \n    SilverWeather\n    | project-rename weather_bronze_timestamp=bronze_timestamp, weather_silver_timestamp = silver_timestamp\n    | extend weather_gold_timestamp = now()\n    | extend polygon_wkt = strcat(\"POLYGON((\", polygon.coordinates,\"))\")\n    | extend polygon_wkt = replace_string(polygon_wkt, \",\", \" \")\n    | extend polygon_wkt = replace_string(polygon_wkt, \"[\", \"\")\n    | extend polygon_wkt = replace_string(polygon_wkt, \"] \", \", \")\n    | extend polygon_wkt = replace_string(polygon_wkt, \"]\", \"\")\n    | summarize arg_max(weather_bronze_timestamp, *) by isigmetId\n}","commandInContext":".create materialized-view with (backfill=true) GoldWeather on table SilverWeather\n{ \n    SilverWeather\n    | project-rename weather_bronze_timestamp=bronze_timestamp, weather_silver_timestamp = silver_timestamp\n    | extend weather_gold_timestamp = now()\n    | extend polygon_wkt = strcat(\"POLYGON((\", polygon.coordinates,\"))\")\n    | extend polygon_wkt = replace_string(polygon_wkt, \",\", \" \")\n    | extend polygon_wkt = replace_string(polygon_wkt, \"[\", \"\")\n    | extend polygon_wkt = replace_string(polygon_wkt, \"] \", \", \")\n    | extend polygon_wkt = replace_string(polygon_wkt, \"]\", \"\")\n    | summarize arg_max(weather_bronze_timestamp, *) by isigmetId\n}","executionStatus":"done","clientRequestId":"Kusto.Web.RTA.QuerySet;be8fb24a-ec74-4e79-889d-574230c0793d;b412f3a0-c089-4067-b197-0d3a584622b5","entityInContext":"trd-kz4sd5vknmz3u5t26m.z2/ac257cd3-e45d-4c3c-a1d8-b4589541f6c8","commandType":"AdminCommand","commandWithoutLeadingComments":".create materialized-view with (backfill=true) GoldWeather on table SilverWeather\n{ \n    SilverWeather\n    | project-rename weather_bronze_timestamp=bronze_timestamp, weather_silver_timestamp = silver_timestamp\n    | extend weather_gold_timestamp = now()\n    | extend polygon_wkt = strcat(\"POLYGON((\", polygon.coordinates,\"))\")\n    | extend polygon_wkt = replace_string(polygon_wkt, \",\", \" \")\n    | extend polygon_wkt = replace_string(polygon_wkt, \"[\", \"\")\n    | extend polygon_wkt = replace_string(polygon_wkt, \"] \", \", \")\n    | extend polygon_wkt = replace_string(polygon_wkt, \"]\", \"\")\n    | summarize arg_max(weather_bronze_timestamp, *) by isigmetId\n}","hideEmptyColumns":false,"cursorPosition":{"lineNumber":11,"column":1}}],"tabInContext":"20577acf-15a6-4b0d-8baf-3743cc36abea","connections":{"trd-kz4sd5vknmz3u5t26m.z2":{"clusterType":"Engine","name":"trd-kz4sd5vknmz3u5t26m.z2","connectionString":"https://trd-kz4sd5vknmz3u5t26m.z2.kusto.fabric.microsoft.com","initialCatalog":"ac257cd3-e45d-4c3c-a1d8-b4589541f6c8","databases":{"trd-kz4sd5vknmz3u5t26m.z2/ac257cd3-e45d-4c3c-a1d8-b4589541f6c8":{"id":"trd-kz4sd5vknmz3u5t26m.z2/ac257cd3-e45d-4c3c-a1d8-b4589541f6c8","name":"ac257cd3-e45d-4c3c-a1d8-b4589541f6c8","prettyName":"eh","fetchState":"notStarted","fetchStateError":"","tables":{},"functions":{},"entityGroups":{},"accessMode":"ReadWrite","minorVersion":0,"majorVersion":16560}},"id":"trd-kz4sd5vknmz3u5t26m.z2","fetchState":"done","fetchStateError":"","tooBigToCache":true,"serviceOffering":"Trident"}}}}